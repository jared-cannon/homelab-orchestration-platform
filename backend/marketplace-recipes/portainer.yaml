id: portainer
name: Portainer
slug: portainer
category: infrastructure
tagline: "Powerful Docker management UI"
description: "Feature-rich web interface for managing Docker containers, images, networks, and volumes. Perfect for advanced container management, monitoring, and troubleshooting. Integrates seamlessly with this platform's deployments."

icon_url: "https://cdn.jsdelivr.net/gh/walkxcode/dashboard-icons/png/portainer.png"

# Resource requirements
resources:
  min_ram_mb: 256
  min_storage_gb: 1
  recommended_ram_mb: 512
  recommended_storage_gb: 2
  cpu_cores: 1

# Docker compose template
compose_template: |
  version: '3.8'
  services:
    portainer:
      image: portainer/portainer-ce:{{.Version}}
      container_name: {{.ContainerName}}
      restart: unless-stopped
      command: {{if .HideLabels}}--hide-label owner=homelab-orchestrator{{end}}
      ports:
        - "{{.WebPort}}:9000"
        {{if .EnableEdgeAgent}}
        - "{{.EdgePort}}:8000"
        {{end}}
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock
        - portainer-data:/data
      {{if .EnableProxy}}
      networks:
        - homelab-proxy
      labels:
        - "traefik.enable=true"
        - "traefik.http.routers.portainer.rule=Host(`{{.Domain}}`)"
        - "traefik.http.routers.portainer.entrypoints=websecure"
        - "traefik.http.routers.portainer.tls.certresolver=letsencrypt"
        - "traefik.http.services.portainer.loadbalancer.server.port=9000"
        - "traefik.docker.network=homelab-proxy"
      {{end}}

  volumes:
    portainer-data:

  {{if .EnableProxy}}
  networks:
    homelab-proxy:
      external: true
  {{end}}

# User-configurable options
config_options:
  - name: version
    label: "Portainer Version"
    type: string
    default: "latest"
    required: true
    description: "Portainer Docker image tag (use 'latest' or specific version like '2.19')"

  - name: container_name
    label: "Container Name"
    type: string
    default: "portainer"
    required: true
    description: "Name for the Docker container"

  - name: web_port
    label: "Web UI Port"
    type: number
    default: 9000
    required: true
    description: "Port to access Portainer web interface"

  - name: enable_proxy
    label: "Enable Traefik Proxy"
    type: boolean
    default: false
    description: "Use Traefik reverse proxy (requires Traefik to be installed)"

  - name: domain
    label: "Domain (if using proxy)"
    type: string
    default: "portainer.homelab.local"
    required: false
    description: "Domain for accessing Portainer via Traefik"

  - name: enable_edge_agent
    label: "Enable Edge Agent"
    type: boolean
    default: false
    description: "Enable Edge Agent for managing remote devices"

  - name: edge_port
    label: "Edge Agent Port"
    type: number
    default: 8000
    required: false
    description: "Port for Edge Agent communication"

  - name: hide_labels
    label: "Hide Platform Containers"
    type: boolean
    default: true
    description: "Hide containers deployed by this platform from Portainer (cleaner view)"

# Post-deployment instructions
post_deploy_instructions: |
  ðŸŽ‰ Portainer is now running!

  **Access Portainer:**
  {{if .EnableProxy}}
  - URL: https://{{.Domain}}
  {{else}}
  - URL: http://<device-ip>:{{.WebPort}}
  {{end}}

  **First Time Setup:**
  1. Open Portainer in your browser
  2. Create an admin account (username & password)
  3. Select "Docker" as the environment type
  4. Click "Connect" - Portainer is now managing this device!

  **Integration with Homelab Orchestrator:**
  - All containers deployed through this platform are visible in Portainer
  - Use Portainer for advanced management:
    - View real-time container logs
    - Execute commands inside containers
    - Monitor resource usage and stats
    - Manage networks and volumes
    - Browse container filesystems

  - Look for the "Manage in Portainer" button on deployed apps
  - This button deep-links directly to the container in Portainer

  **Managing Multiple Devices:**
  {{if .EnableEdgeAgent}}
  Edge Agent is enabled! To add other homelab devices:
  1. Go to Environments â†’ Add Environment
  2. Select "Edge Agent"
  3. Follow the instructions to install the agent on other devices
  {{else}}
  To manage other devices:
  1. Deploy Portainer to each device via this platform
  2. OR enable Edge Agent and install agents on remote devices
  {{end}}

  **Tips:**
  - Use Portainer for troubleshooting when containers aren't working
  - The "Console" feature lets you exec into containers without SSH
  - "Stacks" view shows all your docker-compose deployments
  - Resource usage charts help identify performance issues

  **Security:**
  - Change the admin password regularly
  - {{if not .EnableProxy}}Consider putting Portainer behind Traefik for HTTPS{{end}}
  - Enable local user authentication in Settings if needed
  - Review Access Control settings for multi-user setups

# Health check
health_check:
  path: "/api/status"
  expected_status: 200
  timeout_seconds: 30
